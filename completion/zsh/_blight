#compdef blight

__blight() {
	blight "$@" 2>/dev/null
}

local -a getable=( ${(@f)"$(__blight get help)"} )

_regex_arguments _blight_action /$'[^\0]#\0'/ \
	/$'(get|set)\0'/ :'compadd get set' \
	\( /$'get\0'/ :'compadd -a getable' \| \
	   /$'set\0'/ \)

local -a devices=( /sys/class/*/*/brightness(N:h:t2) )
_arguments -s -S \
	{-d,--device=}'[Device to manipulate]:device:_multi_parts / devices' \
	'*::action:= _blight_action'
